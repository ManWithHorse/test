Отличный и очень практичный вопрос. Определение размера выборки (количества животных) для такого эксперимента — ключевой этап, который напрямую влияет на достоверность будущих выводов.

Вот пошаговый алгоритм, как это сделать, с объяснением логики.

### Краткая суть подхода

Мы определяем количество животных не исходя из "процента от поголовья", а исходя из **статистической мощности**. Это вероятность того, что эксперимент обнаружит эффект, если он действительно есть. Стандартная рекомендуемая мощность — 80% или выше.

Для расчета нам нужно оценить несколько параметров.

---

### Шаг 1: Определите параметры для расчета

Вам понадобятся следующие данные:

1.  **Минимальный значимый эффект (Minimum Detectable Effect - MDE).** Насколько сильное изменение вы ожидаете от нового корма?
    *   Для **среднего веса (25 кг)**: Насколько вес в новой группе должен отличаться от текущего среднего? Например, если сейчас средний вес 24 кг, а вы хотите увидеть эффект до 25 кг, то MDE = 1 кг.
    *   Для **среднего привеса (350 г/сут)**: Если сейчас привес 330 г/сут, а цель — 350 г/сут, то MDE = 20 г/сут.
    *   *Важно:* Эксперимент должен быть рассчитан на обнаружение **наименьшего из эффектов, который имеет экономический смысл**.

2.  **Разброс данных (Стандартное отклонение - σ).** Это самый важный и часто недооцениваемый параметр. Он показывает, насколько "разбросаны" данные вокруг среднего значения.
    *   *Откуда взять?* Проанализируйте исторические данные по вашему комплексу. Посчитайте стандартное отклонение по весу при переводе и по суточному привесу за последние несколько месяцев. Если исторических данных нет, используйте экспертную оценку (например, технолог может сказать, что вес свиней при переводе обычно колеблется от 22 до 28 кг — это поможет грубо оценить σ).

3.  **Уровень значимости (α).** Это вероятность "ложной тревоги" — что мы решим, что эффект есть, когда на самом деле его нет. Обычно используют α = 0.05 (5%).

4.  **Статистическая мощность (1-β).** Вероятность обнаружить эффект, если он есть. Обычно используют 0.8 (80%) или 0.9 (90%).

---

### Шаг 2: Выбор формулы и расчет

Поскольку вы сравниваете среднее значение в экспериментальной группе (новый корм) с целевым показателем (350 г, 25 кг), используется **тест на одно среднее (one-sample t-test)**.

**Формула для расчета размера выборки (n):**

`n = [ (Z_(1-α/2) + Z_(1-β) ) * σ / Δ ]²`

Где:
*   `Z_(1-α/2)` — Z-значение для уровня значимости. Для α=0.05 это **1.96**.
*   `Z_(1-β)` — Z-значение для мощности. Для мощности 80% это **0.84**, для 90% — **1.28**.
*   `σ` — стандартное отклонение (оценка из исторических данных).
*   `Δ` — минимальный значимый эффект (MDE).

### Шаг 3: Пример расчета

Допустим, мы рассчитываем для показателя **"вес при переводе"**.

*   **Цель:** 25 кг.
*   **Текущий средний вес (исторический):** 24 кг.
*   **Минимальный значимый эффект (Δ):** 25 - 24 = **1 кг**.
*   **Стандартное отклонение (σ) из исторических данных:** допустим, 1.5 кг.
*   **Уровень значимости (α):** 0.05 (Z = 1.96)
*   **Мощность (1-β):** 80% (Z = 0.84)

Подставляем в формулу:
`n = [ (1.96 + 0.84) * 1.5 / 1 ]² = [ (2.8) * 1.5 ]² = [4.2]² = 17.64`

**Вывод:** Для показателя "вес" нам потребуется **не менее 18 животных** в экспериментальной группе, чтобы с 80% вероятностью обнаружить увеличение веса с 24 кг до 25 кг.

### Шаг 4: Расчет для привеса и итоговый размер группы

Теперь проделайте те же расчеты для показателя **"среднесуточный привес"**.

*   **Цель:** 350 г/сут.
*   **Текущий привес:** 330 г/сут.
*   **MDE (Δ):** 20 г/сут.
*   **Стандартное отклонение (σ) для привеса:** (допустим, из данных) 15 г/сут.

`n = [ (1.96 + 0.84) * 15 / 20 ]² = [ (2.8) * 0.75 ]² = [2.1]² = 4.41`

**Вывод:** Для показателя "привес" теоретически хватит **5 животных**.

### Шаг 5: Принятие окончательного решения

Вы получили два разных числа: 18 животных для веса и 5 для привеса.

**Правило: всегда берите наибольшее рассчитанное значение.**

В нашем примере эксперимент должен включать **не менее 18 животных** в группе на новом корме.

**Почему так?**
Если мы возьмем 5 животных, мы можем с высокой вероятностью обнаружить эффект по привесу, но у нас почти не будет шансов обнаружить эффект по весу (мощность теста для веса будет очень низкой). Взяв 18, мы обеспечиваем достаточную мощность для обоих ключевых показателей.

---

### Практические рекомендации и подводные камни

1.  **Увеличьте размер группы "с запасом".** Животные могут заболеть, данные могут быть испорчены. Всегда закладывайте запас. В нашем примере с n=18 разумно взять **25-30 животных**. Это снизит риски и повысит надежность.
2.  **Контрольная группа — обязательна!** Вы не можете сравнивать результаты только с "историческими данными" или "планом". Условия могли измениться. Нужна параллельная контрольная группа, которая в тот же период времени получает старый корм. Размер контрольной группы должен быть **таким же, как и экспериментальной** (т.е. тоже 25-30 животных).
3.  **Рандомизация.** Животные должны быть случайным образом распределены в контрольную и экспериментальную группы. Это нивелирует влияние побочных факторов (например, изначально более крепкие поросята в одной группе).
4.  **Слепота (ослепление) эксперимента.** По возможности, персонал, ухаживающий за животными и взвешивающий их, не должен знать, какая группа какая корм получает. Это исключает подсознательное влияние на результат.
5.  **Один фактор за раз.** В этом эксперименте меняется только корм. Все остальные условия (плотность посадки, температура, ветеринарные процедуры) должны быть идентичными для обеих групп.

### Итог

Чтобы определить количество животных для эксперимента:

1.  Возьмите исторические данные для оценки стандартного отклонения (σ).
2.  Определите, какое минимальное изменение (Δ) для веса и привеса вы считаете значимым.
3.  Рассчитайте размер группы отдельно для каждого показателя по формуле для t-теста.
4.  Выберите **наибольшее** из полученных значений `n`.
5.  **Добавьте запас** (20-30%) на случай отбраковки.
6.  **Сформируйте контрольную группу такого же размера.**

Для вашего эксперимента с целевыми показателями **350 г/сут и 25 кг** общее количество животных (эксперимент + контроль) будет, скорее всего, находиться в диапазоне **от 50 до 70 голов**. Точную цифру даст только расчет на основе ваших конкретных исторических данных.
